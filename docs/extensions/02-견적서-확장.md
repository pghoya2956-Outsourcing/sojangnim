---
title: "ê²¬ì ì„œ í™•ì¥ ê¸°ëŠ¥"
tags: [extensions, quotation, csv, export]
---

# ğŸ“„ ê²¬ì ì„œ í™•ì¥ ê¸°ëŠ¥

ê²¬ì ì„œì— CSV ë‚´ë³´ë‚´ê¸°, ì—°ë½ì²˜ ì •ë³´ ì¶”ê°€ ë“± í™•ì¥ ê¸°ëŠ¥ì„ êµ¬í˜„í•˜ëŠ” ë°©ë²•ì„ ì•ˆë‚´í•©ë‹ˆë‹¤.

## ğŸ“‹ í™•ì¥ ê¸°ëŠ¥ ëª©ë¡

| ê¸°ëŠ¥ | ê³µìˆ˜ | ë‚œì´ë„ | ì„¤ëª… |
|-----|------|-------|-----|
| CSV ë‚´ë³´ë‚´ê¸° | 1~2ì‹œê°„ | ì‰¬ì›€ | ê²¬ì ì„œ ë°ì´í„°ë¥¼ CSV íŒŒì¼ë¡œ ë‹¤ìš´ë¡œë“œ |
| ì—°ë½ì²˜ ì¶”ê°€ | 30ë¶„ | ë§¤ìš° ì‰¬ì›€ | ì „í™”/íŒ©ìŠ¤ ë“± íšŒì‚¬ ì—°ë½ì²˜ í‘œì‹œ |

---

## ğŸ”§ 1. ì—°ë½ì²˜ ì •ë³´ ì¶”ê°€

ê²¬ì ì„œì— ì „í™”ë²ˆí˜¸, íŒ©ìŠ¤ ë“± ì—°ë½ì²˜ë¥¼ í‘œì‹œí•©ë‹ˆë‹¤.

### ìˆ˜ì • íŒŒì¼

```
src/types/quotation.ts          # íƒ€ì… ì •ì˜
src/lib/quotation/config.ts     # í™˜ê²½ë³€ìˆ˜ ì½ê¸°
src/components/quotation/QuotationTemplate.tsx  # UI í‘œì‹œ
.env.production                 # í™˜ê²½ë³€ìˆ˜ ê°’
```

### Step 1: íƒ€ì… ì •ì˜ ìˆ˜ì •

**`src/types/quotation.ts`**

```typescript
export interface CompanyInfo {
  businessNumber: string
  name: string
  representative: string
  address: string
  businessType: string
  businessCategory: string
  sealImage?: string
  // ì¶”ê°€
  phone?: string              // ì „í™”ë²ˆí˜¸
  fax?: string                // íŒ©ìŠ¤ë²ˆí˜¸
  email?: string              // ì´ë©”ì¼ (ì„ íƒ)
}
```

### Step 2: í™˜ê²½ë³€ìˆ˜ ì½ê¸° ì¶”ê°€

**`src/lib/quotation/config.ts`**

```typescript
export function getCompanyInfo(): CompanyInfo {
  return {
    businessNumber: process.env.NEXT_PUBLIC_COMPANY_BUSINESS_NUMBER || '',
    name: process.env.NEXT_PUBLIC_COMPANY_NAME || '',
    representative: process.env.NEXT_PUBLIC_COMPANY_REPRESENTATIVE || '',
    address: process.env.NEXT_PUBLIC_COMPANY_ADDRESS || '',
    businessType: process.env.NEXT_PUBLIC_COMPANY_BUSINESS_TYPE || '',
    businessCategory: process.env.NEXT_PUBLIC_COMPANY_BUSINESS_CATEGORY || '',
    sealImage: process.env.NEXT_PUBLIC_COMPANY_SEAL_IMAGE || undefined,
    // ì¶”ê°€
    phone: process.env.NEXT_PUBLIC_COMPANY_PHONE || undefined,
    fax: process.env.NEXT_PUBLIC_COMPANY_FAX || undefined,
    email: process.env.NEXT_PUBLIC_COMPANY_EMAIL || undefined,
  }
}
```

### Step 3: í™˜ê²½ë³€ìˆ˜ ì¶”ê°€

**`.env.production`**

```bash
# íšŒì‚¬ ì—°ë½ì²˜
NEXT_PUBLIC_COMPANY_PHONE=02-2275-0861
NEXT_PUBLIC_COMPANY_FAX=02-2275-0865
NEXT_PUBLIC_COMPANY_EMAIL=contact@example.com  # ì„ íƒ
```

### Step 4: í…œí”Œë¦¿ì—ì„œ í‘œì‹œ

**`src/components/quotation/QuotationTemplate.tsx`**

ê³µê¸‰ì ì •ë³´ í…Œì´ë¸”ì— ì—°ë½ì²˜ í–‰ ì¶”ê°€:

```tsx
{company.phone && (
  <tr>
    <td className="...">ì „í™”</td>
    <td className="...">{company.phone}</td>
  </tr>
)}
{company.fax && (
  <tr>
    <td className="...">íŒ©ìŠ¤</td>
    <td className="...">{company.fax}</td>
  </tr>
)}
```

---

## ğŸ“Š 2. CSV ë‚´ë³´ë‚´ê¸°

ê²¬ì ì„œ ë°ì´í„°ë¥¼ CSV íŒŒì¼ë¡œ ë‹¤ìš´ë¡œë“œí•˜ëŠ” ê¸°ëŠ¥ì…ë‹ˆë‹¤.

### ì¶”ê°€ íŒŒì¼

```
src/lib/quotation/csv.ts        # CSV ë³€í™˜ ìœ í‹¸ë¦¬í‹°
src/components/quotation/CSVDownloadButton.tsx  # ë‹¤ìš´ë¡œë“œ ë²„íŠ¼
```

### Step 1: CSV ë³€í™˜ í•¨ìˆ˜

**`src/lib/quotation/csv.ts`** (ìƒˆ íŒŒì¼)

```typescript
import type { QuotationData } from '@/types/quotation'
import { formatNumber } from './generator'

/**
 * ê²¬ì ì„œ ë°ì´í„°ë¥¼ CSV ë¬¸ìì—´ë¡œ ë³€í™˜
 */
export function convertToCSV(data: QuotationData): string {
  const lines: string[] = []

  // BOM (Excel í•œê¸€ ê¹¨ì§ ë°©ì§€)
  const BOM = '\uFEFF'

  // í—¤ë” ì •ë³´
  lines.push(`ê²¬ì ì„œ ë²ˆí˜¸,${data.metadata.number}`)
  lines.push(`ì‘ì„±ì¼ì,${data.metadata.date}`)
  lines.push(`ìˆ˜ì‹ ì,${data.recipient.name}`)
  lines.push(`ê³µê¸‰ì,${data.company.name}`)
  lines.push('')

  // í’ˆëª© í—¤ë”
  lines.push('ìˆœë²ˆ,í’ˆëª©ëª…,ê·œê²©,ìˆ˜ëŸ‰,ë‹¨ê°€,ê³µê¸‰ê°€ì•¡,ì„¸ì•¡')

  // í’ˆëª© ë°ì´í„°
  data.items.forEach(item => {
    lines.push([
      item.seq,
      `"${item.name}"`,  // ì‰¼í‘œ í¬í•¨ ê°€ëŠ¥ì„± ëŒ€ë¹„
      `"${item.spec}"`,
      item.quantity,
      formatNumber(item.unitPrice),
      formatNumber(item.supplyPrice),
      formatNumber(item.taxAmount),
    ].join(','))
  })

  // í•©ê³„
  lines.push('')
  lines.push(`ê³µê¸‰ê°€ì•¡ í•©ê³„,,,,,"${formatNumber(data.totalSupplyPrice)}",`)
  lines.push(`ì„¸ì•¡ í•©ê³„,,,,,,"${formatNumber(data.totalTaxAmount)}"`)
  lines.push(`ì´ í•©ê³„,,,,,"${formatNumber(data.totalAmount)}",`)

  return BOM + lines.join('\n')
}

/**
 * CSV íŒŒì¼ ë‹¤ìš´ë¡œë“œ
 */
export function downloadCSV(data: QuotationData): void {
  const csv = convertToCSV(data)
  const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' })
  const url = URL.createObjectURL(blob)

  const link = document.createElement('a')
  link.href = url
  link.download = `ê²¬ì ì„œ_${data.metadata.number}.csv`
  link.click()

  URL.revokeObjectURL(url)
}
```

### Step 2: ë‹¤ìš´ë¡œë“œ ë²„íŠ¼ ì»´í¬ë„ŒíŠ¸

**`src/components/quotation/CSVDownloadButton.tsx`** (ìƒˆ íŒŒì¼)

```tsx
'use client'

import type { QuotationData } from '@/types/quotation'
import { downloadCSV } from '@/lib/quotation/csv'

interface Props {
  data: QuotationData
}

export default function CSVDownloadButton({ data }: Props) {
  const handleDownload = () => {
    downloadCSV(data)
  }

  return (
    <button
      onClick={handleDownload}
      className="px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 transition-colors"
    >
      CSV ë‹¤ìš´ë¡œë“œ
    </button>
  )
}
```

### Step 3: ê²¬ì ì„œ í˜ì´ì§€ì— ë²„íŠ¼ ì¶”ê°€

ê¸°ì¡´ ì¸ì‡„ ë²„íŠ¼ ì˜†ì— CSV ë‹¤ìš´ë¡œë“œ ë²„íŠ¼ ì¶”ê°€:

```tsx
import CSVDownloadButton from '@/components/quotation/CSVDownloadButton'

// ë²„íŠ¼ ì˜ì—­
<div className="flex gap-2 print:hidden">
  <button onClick={handlePrint}>ì¸ì‡„í•˜ê¸°</button>
  <CSVDownloadButton data={quotationData} />
</div>
```

---

## ğŸ“ CSV ì¶œë ¥ ì˜ˆì‹œ

```csv
ê²¬ì ì„œ ë²ˆí˜¸,20250125-143025
ì‘ì„±ì¼ì,2025-01-25
ìˆ˜ì‹ ì,í™ê¸¸ë™
ê³µê¸‰ì,ì‹ ì•”ìƒì‚¬

ìˆœë²ˆ,í’ˆëª©ëª…,ê·œê²©,ìˆ˜ëŸ‰,ë‹¨ê°€,ê³µê¸‰ê°€ì•¡,ì„¸ì•¡
1,"ë¬´ì„  ë“œë¦´","20V ë¦¬íŠ¬ì´ì˜¨ ë°°í„°ë¦¬",2,"150,000","300,000","30,000"
2,"ì „ë™ ë“œë¼ì´ë²„","ì¶©ì „ì‹ 6mm",1,"89,000","89,000","8,900"

ê³µê¸‰ê°€ì•¡ í•©ê³„,,,,,"389,000",
ì„¸ì•¡ í•©ê³„,,,,,,"38,900"
ì´ í•©ê³„,,,,,"427,900",
```

---

## ğŸ”® ì¶”ê°€ í™•ì¥ ì•„ì´ë””ì–´

### Excel ë‚´ë³´ë‚´ê¸° (xlsx)
- `xlsx` ë˜ëŠ” `exceljs` ë¼ì´ë¸ŒëŸ¬ë¦¬ ì‚¬ìš©
- ìŠ¤íƒ€ì¼ë§, ì…€ ë³‘í•© ë“± ê³ ê¸‰ ê¸°ëŠ¥ ê°€ëŠ¥
- ê³µìˆ˜: 2~3ì‹œê°„

### PDF ë‹¤ìš´ë¡œë“œ
- `jspdf` + `html2canvas` ì¡°í•©
- í˜„ì¬ ì¸ì‡„ í…œí”Œë¦¿ì„ PDFë¡œ ë³€í™˜
- ê³µìˆ˜: 3~4ì‹œê°„

### ì´ë©”ì¼ ì „ì†¡
- ê²¬ì ì„œë¥¼ ì´ë©”ì¼ë¡œ ë°œì†¡
- Supabase Edge Functions ë˜ëŠ” ì™¸ë¶€ ì´ë©”ì¼ ì„œë¹„ìŠ¤ ì—°ë™
- ê³µìˆ˜: 4~6ì‹œê°„

---

## ğŸ“š ê´€ë ¨ ë¬¸ì„œ

- **[ê²¬ì ì„œ íƒ€ì… ì •ì˜](../../src/types/quotation.ts)** - QuotationData êµ¬ì¡°
- **[ê²¬ì ì„œ ìƒì„±ê¸°](../../src/lib/quotation/generator.ts)** - ë°ì´í„° ë³€í™˜ ë¡œì§
- **[ê²¬ì ì„œ í…œí”Œë¦¿](../../src/components/quotation/QuotationTemplate.tsx)** - UI ì»´í¬ë„ŒíŠ¸

---

**ë¬¸ì„œ ìµœì¢… ì—…ë°ì´íŠ¸**: 2025-01-25
